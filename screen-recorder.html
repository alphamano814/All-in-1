<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  
  <!-- SEO Meta Tags -->
  <title>Screen Recorder | Free Online Screen Capture - Prabin's Toolbox</title>
  <meta name="description" content="Record your screen online for free with Prabin's Toolbox. Capture video with or without audio, preview, and download instantly — no software required.">
  <meta name="keywords" content="screen recorder, online screen capture, record screen, free screen recorder, screen video capture, browser-based screen recorder, mp4 screen recorder">
  <meta name="author" content="Prabin's Toolbox">
  <link rel="canonical" href="https://www.prabinpokhrel1.com.np/screen-recorder.html">
  
  <!-- Open Graph Meta Tags -->
  <meta property="og:title" content="Screen Recorder | Free Online Screen Capture - Prabin's Toolbox">
  <meta property="og:description" content="Record your screen instantly online. Capture video and audio with privacy — no uploads, no software required.">
  <meta property="og:image" content="https://www.prabinpokhrel1.com.np/images/screen-recorder-og.jpg">
  <meta property="og:url" content="https://www.prabinpokhrel1.com.np/screen-recorder.html">
  <meta property="og:type" content="website">
  <meta property="og:site_name" content="All-in-One Tools by Prabin">
  
  <!-- Twitter Card Meta Tags -->
  <meta name="twitter:card" content="summary_large_image">
  <meta name="twitter:title" content="Screen Recorder Online - Prabin's Toolbox">
  <meta name="twitter:description" content="Capture your screen with or without audio instantly in your browser. Download your recording as MP4/WebM.">
  <meta name="twitter:image" content="https://www.prabinpokhrel1.com.np/images/screen-recorder-twitter.jpg">
  <meta name="twitter:creator" content="@prabinpokhrel">
  
  <!-- Favicon -->
  <link rel="icon" href="/favicon.ico" type="image/x-icon">
  <link rel="shortcut icon" href="/favicon.ico" type="image/x-icon">
  
  <!-- Font Awesome -->
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
  
  <!-- Structured Data -->
  <script type="application/ld+json">
  {
    "@context": "https://schema.org",
    "@type": "WebApplication",
    "name": "Online Screen Recorder",
    "description": "Record your screen online for free with Prabin's Toolbox. Capture video with or without audio, preview, and download instantly.",
    "url": "https://www.prabinpokhrel1.com.np/screen-recorder.html",
    "applicationCategory": "UtilityApplication",
    "operatingSystem": "Any",
    "permissions": "microphone, display-capture",
    "offers": {
      "@type": "Offer",
      "price": "0",
      "priceCurrency": "USD"
    },
    "author": {
      "@type": "Person",
      "name": "Prabin Pokhrel"
    },
    "publisher": {
      "@type": "Organization",
      "name": "Prabin's Toolbox"
    }
  }
  </script>
  <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-7081789084626782"
     crossorigin="anonymous"></script>
  
  <style>
    /* --------- RESET & VARIABLES --------- */
    * { 
      margin: 0; 
      padding: 0; 
      box-sizing: border-box; 
      font-family: "Poppins", sans-serif; 
      transition: background-color 0.3s, color 0.3s;
    }

    :root {
      --primary: #38bdf8;
      --primary-dark: #0ea5e9;
      --secondary: #f472b6;
      --accent: #a78bfa;
      --bg: #0f172a;
      --bg-light: #1e293b;
      --bg-lighter: #334155;
      --text: #f1f5f9;
      --text-muted: #94a3b8;
      --card-bg: rgba(255, 255, 255, 0.05);
      --card-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -1px rgba(0, 0, 0, 0.06);
      --border: rgba(255, 255, 255, 0.1);
      --success: #10b981;
      --error: #ef4444;
      --warning: #f59e0b;
    }

    .light-mode {
      --bg: #f8fafc;
      --bg-light: #e2e8f0;
      --bg-lighter: #cbd5e1;
      --text: #0f172a;
      --text-muted: #475569;
      --card-bg: rgba(255, 255, 255, 0.8);
      --card-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.05), 0 2px 4px -1px rgba(0, 0, 0, 0.03);
      --border: rgba(0, 0, 0, 0.1);
    }

    body {
      background: linear-gradient(135deg, var(--bg), var(--bg-light));
      color: var(--text);
      min-height: 100vh;
      display: flex;
      flex-direction: column;
      align-items: center;
      transition: background 0.5s ease;
      padding: 0 1rem;
    }

    /* --------- HEADER & NAVIGATION --------- */
    header {
      width: 100%;
      padding: 1.5rem 1rem;
      text-align: center;
      background: rgba(255, 255, 255, 0.05);
      backdrop-filter: blur(10px);
      border-bottom: 1px solid var(--border);
      position: relative;
      z-index: 100;
    }

    .header-content {
      max-width: 1200px;
      margin: 0 auto;
      display: flex;
      justify-content: space-between;
      align-items: center;
    }

    .logo {
      display: flex;
      align-items: center;
      gap: 10px;
    }

    .logo i {
      font-size: 2.5rem;
      color: var(--primary);
      animation: rotate 10s linear infinite;
    }

    @keyframes rotate {
      0% { transform: rotate(0deg); }
      100% { transform: rotate(360deg); }
    }

    .logo h1 {
      font-size: 2rem;
      color: var(--primary);
      letter-spacing: 1px;
    }

    .logo p {
      margin-top: 0.5rem;
      color: var(--text-muted);
      font-size: 1rem;
    }

    .theme-toggle {
      background: var(--card-bg);
      border: 1px solid var(--border);
      border-radius: 50px;
      width: 60px;
      height: 30px;
      position: relative;
      cursor: pointer;
      display: flex;
      align-items: center;
      padding: 0 5px;
      transition: all 0.3s ease;
    }

    .theme-toggle:hover {
      transform: scale(1.05);
    }

    .theme-toggle i {
      position: absolute;
      font-size: 1.2rem;
      transition: all 0.3s ease;
    }

    .theme-toggle .fa-sun {
      color: #f59e0b;
      opacity: 0;
    }

    .theme-toggle .fa-moon {
      color: #94a3b8;
    }

    .light-mode .theme-toggle .fa-sun {
      opacity: 1;
    }

    .light-mode .theme-toggle .fa-moon {
      opacity: 0;
    }

    .theme-toggle::after {
      content: '';
      position: absolute;
      width: 22px;
      height: 22px;
      border-radius: 50%;
      background: var(--primary);
      transition: all 0.3s ease;
      left: 4px;
    }

    .light-mode .theme-toggle::after {
      left: calc(100% - 26px);
      background: #f59e0b;
    }

    /* --------- MAIN CONTENT --------- */
    main {
      max-width: 1200px;
      width: 100%;
      margin: 2rem auto;
      padding: 0 1rem;
    }

    .recorder-card {
      background: var(--card-bg);
      border-radius: 15px;
      padding: 2rem;
      box-shadow: var(--card-shadow);
      backdrop-filter: blur(10px);
      border: 1px solid var(--border);
      margin-bottom: 2rem;
      animation: fadeIn 0.8s ease;
    }

    @keyframes fadeIn {
      from { opacity: 0; transform: translateY(20px); }
      to { opacity: 1; transform: translateY(0); }
    }

    .card-header {
      text-align: center;
      margin-bottom: 2rem;
    }

    .card-header h1 {
      font-size: 1.8rem;
      color: var(--primary);
      margin-bottom: 0.5rem;
    }

    .card-header p {
      color: var(--text-muted);
    }

    .card-header i {
      font-size: 3rem;
      color: var(--primary);
      margin-bottom: 1rem;
    }

    /* --------- RECORDER CONTROLS --------- */
    .recorder-controls {
      display: flex;
      flex-wrap: wrap;
      gap: 1rem;
      margin-bottom: 2rem;
      justify-content: center;
    }

    .control-btn {
      padding: 0.8rem 1.5rem;
      border: none;
      border-radius: 10px;
      font-size: 1rem;
      font-weight: 600;
      cursor: pointer;
      transition: all 0.3s ease;
      display: flex;
      align-items: center;
      gap: 0.5rem;
    }

    .control-btn:disabled {
      opacity: 0.5;
      cursor: not-allowed;
    }

    .control-btn:disabled:hover {
      transform: none;
    }

    .start-btn {
      background: var(--success);
      color: white;
    }

    .start-btn:hover:not(:disabled) {
      background: #0da271;
      transform: translateY(-3px);
    }

    .pause-btn {
      background: var(--warning);
      color: white;
    }

    .pause-btn:hover:not(:disabled) {
      background: #d97706;
      transform: translateY(-3px);
    }

    .stop-btn {
      background: var(--error);
      color: white;
    }

    .stop-btn:hover:not(:disabled) {
      background: #dc2626;
      transform: translateY(-3px);
    }

    .download-btn {
      background: var(--primary);
      color: white;
    }

    .download-btn:hover:not(:disabled) {
      background: var(--primary-dark);
      transform: translateY(-3px);
    }

    /* --------- RECORDER OPTIONS --------- */
    .recorder-options {
      display: flex;
      flex-wrap: wrap;
      gap: 1.5rem;
      margin-bottom: 2rem;
      justify-content: center;
    }

    .option-group {
      display: flex;
      align-items: center;
      gap: 0.5rem;
    }

    .option-label {
      color: var(--text);
      font-weight: 500;
    }

    .checkbox {
      width: 18px;
      height: 18px;
      accent-color: var(--primary);
    }

    .select-control {
      padding: 0.5rem 1rem;
      border-radius: 8px;
      background: var(--bg-light);
      color: var(--text);
      border: 1px solid var(--border);
      outline: none;
    }

    .select-control:focus {
      border-color: var(--primary);
      box-shadow: 0 0 0 3px rgba(56, 189, 248, 0.2);
    }

    /* --------- PREVIEW SECTION --------- */
    .preview-container {
      background: var(--bg-light);
      border-radius: 10px;
      padding: 1.5rem;
      margin-top: 1.5rem;
      border: 1px solid var(--border);
      transition: all 0.3s ease;
      text-align: center;
      opacity: 0;
      transform: translateY(10px);
      transition: all 0.5s ease;
    }

    .preview-container.active {
      opacity: 1;
      transform: translateY(0);
      border-color: var(--success);
      box-shadow: 0 0 0 3px rgba(16, 185, 129, 0.2);
    }

    .preview-label {
      font-size: 0.9rem;
      color: var(--text-muted);
      margin-bottom: 0.5rem;
    }

    .preview-video {
      width: 100%;
      max-width: 800px;
      border-radius: 8px;
      background: var(--bg);
      aspect-ratio: 16/9;
      margin: 0 auto;
    }

    .timer {
      font-size: 1.2rem;
      font-weight: 600;
      color: var(--primary);
      margin-top: 1rem;
    }

    .status-indicator {
      display: inline-flex;
      align-items: center;
      gap: 0.5rem;
      padding: 0.5rem 1rem;
      border-radius: 50px;
      background: var(--bg-light);
      color: var(--text-muted);
      margin-top: 1rem;
    }

    .status-indicator.recording {
      background: rgba(239, 68, 68, 0.2);
      color: var(--error);
    }

    .status-indicator.paused {
      background: rgba(245, 158, 11, 0.2);
      color: var(--warning);
    }

    /* --------- CONTENT SECTIONS --------- */
    .content-section {
      background: var(--card-bg);
      border-radius: 15px;
      padding: 2rem;
      box-shadow: var(--card-shadow);
      backdrop-filter: blur(10px);
      border: 1px solid var(--border);
      margin-bottom: 2rem;
    }

    .content-section h2 {
      font-size: 1.5rem;
      color: var(--primary);
      margin-bottom: 1rem;
      display: flex;
      align-items: center;
      gap: 0.5rem;
    }

    .content-section h3 {
      font-size: 1.2rem;
      color: var(--secondary);
      margin: 1.5rem 0 0.5rem;
    }

    .content-section p {
      color: var(--text);
      line-height: 1.6;
      margin-bottom: 1rem;
    }

    .content-section ul {
      padding-left: 1.5rem;
      margin-bottom: 1rem;
    }

    .content-section li {
      color: var(--text);
      line-height: 1.6;
      margin-bottom: 0.5rem;
    }

    .faq-item {
      margin-bottom: 1.5rem;
      border-bottom: 1px solid var(--border);
      padding-bottom: 1.5rem;
    }

    .faq-item:last-child {
      border-bottom: none;
      margin-bottom: 0;
    }

    .tool-links {
      display: flex;
      flex-wrap: wrap;
      gap: 1rem;
      margin-top: 1rem;
    }

    .tool-link {
      display: inline-flex;
      align-items: center;
      gap: 0.5rem;
      padding: 0.8rem 1.5rem;
      background: var(--card-bg);
      color: var(--text);
      border: 1px solid var(--border);
      border-radius: 10px;
      text-decoration: none;
      font-weight: 500;
      transition: all 0.3s ease;
    }

    .tool-link:hover {
      background: var(--primary);
      color: white;
      transform: translateY(-3px);
    }

    /* --------- BACK BUTTON --------- */
    .back-btn {
      display: inline-flex;
      align-items: center;
      gap: 0.5rem;
      padding: 0.8rem 1.5rem;
      background: var(--card-bg);
      color: var(--text);
      border: 1px solid var(--border);
      border-radius: 10px;
      text-decoration: none;
      font-weight: 500;
      transition: all 0.3s ease;
      margin-top: 1rem;
    }

    .back-btn:hover {
      background: var(--primary);
      color: white;
      transform: translateX(-5px);
    }

    /* --------- FOOTER --------- */
    footer {
      padding: 2rem 1rem;
      text-align: center;
      color: var(--text-muted);
      font-size: 0.9rem;
      border-top: 1px solid var(--border);
      width: 100%;
      margin-top: auto;
    }

    .footer-content {
      max-width: 1200px;
      margin: 0 auto;
      display: flex;
      flex-direction: column;
      align-items: center;
      gap: 1rem;
    }

    .footer-links {
      display: flex;
      gap: 2rem;
      margin-top: 1rem;
    }

    .footer-links a {
      color: var(--text-muted);
      text-decoration: none;
      transition: color 0.3s ease;
    }

    .footer-links a:hover {
      color: var(--primary);
    }

    /* --------- RESPONSIVE DESIGN --------- */
    @media (max-width: 768px) {
      .header-content {
        flex-direction: column;
        gap: 1rem;
      }

      .recorder-controls {
        flex-direction: column;
        align-items: center;
      }

      .control-btn {
        width: 100%;
        max-width: 250px;
        justify-content: center;
      }

      .recorder-options {
        flex-direction: column;
        align-items: center;
      }

      .tool-links {
        justify-content: center;
      }
    }

    @media (max-width: 480px) {
      .footer-links {
        flex-direction: column;
        gap: 1rem;
      }
    }
  </style>
</head>
<body>
  <header>
    <div class="header-content">
      <div class="logo">
        <i class="fas fa-toolbox" aria-hidden="true"></i>
        <div>
          <h1>All-in-One Tools</h1>
          <p>50+ useful tools for your everyday needs</p>
        </div>
      </div>
      <div class="theme-toggle" id="themeToggle" aria-label="Toggle dark/light mode" role="button" tabindex="0">
        <i class="fas fa-sun" aria-hidden="true"></i>
        <i class="fas fa-moon" aria-hidden="true"></i>
      </div>
    </div>
  </header>

  <main>
    <article>
      <div class="recorder-card">
        <div class="card-header">
          <i class="fas fa-video" aria-hidden="true"></i>
          <h1>Screen Recorder</h1>
          <p>Record your screen with optional microphone audio - completely in your browser</p>
        </div>

        <div class="recorder-options">
          <div class="option-group">
            <input type="checkbox" id="audioToggle" class="checkbox" checked>
            <label for="audioToggle" class="option-label">Include Microphone Audio</label>
          </div>
          <div class="option-group">
            <label for="videoFormat" class="option-label">Format:</label>
            <select id="videoFormat" class="select-control">
              <option value="webm">WebM (Recommended)</option>
              <option value="mp4">MP4</option>
            </select>
          </div>
        </div>

        <div class="recorder-controls">
          <button class="control-btn start-btn" id="startBtn" aria-label="Start recording">
            <i class="fas fa-record-vinyl" aria-hidden="true"></i> Start Recording
          </button>
          <button class="control-btn pause-btn" id="pauseBtn" disabled aria-label="Pause recording">
            <i class="fas fa-pause" aria-hidden="true"></i> Pause
          </button>
          <button class="control-btn stop-btn" id="stopBtn" disabled aria-label="Stop recording">
            <i class="fas fa-stop" aria-hidden="true"></i> Stop
          </button>
          <button class="control-btn download-btn" id="downloadBtn" disabled aria-label="Download recording">
            <i class="fas fa-download" aria-hidden="true"></i> Download
          </button>
        </div>

        <div class="preview-container" id="previewContainer" aria-live="polite">
          <div class="preview-label">Recording Preview</div>
          <video class="preview-video" id="previewVideo" controls></video>
          <div class="timer" id="timer">00:00:00</div>
          <div class="status-indicator" id="statusIndicator">
            <i class="fas fa-circle" aria-hidden="true"></i> Ready to record
          </div>
        </div>

        <a href="index.html" class="back-btn">
          <i class="fas fa-arrow-left" aria-hidden="true"></i> Back to Home
        </a>
      </div>
    </article>

    <section class="content-section">
      <h2><i class="fas fa-info-circle" aria-hidden="true"></i> About This Screen Recorder</h2>
      <p>Our Online Screen Recorder is a free tool that allows you to capture your screen directly in your browser. Whether you need to create tutorials, record presentations, or capture gameplay, this tool provides high-quality recording with optional audio commentary.</p>
      
      <h3>How to Use the Screen Recorder</h3>
      <p>Using our screen recorder is simple:</p>
      <ul>
        <li>Choose whether to include microphone audio</li>
        <li>Select your preferred video format (WebM recommended for best compatibility)</li>
        <li>Click "Start Recording" and grant permission to share your screen</li>
        <li>Select the screen or application window you want to record</li>
        <li>Use pause/resume to control recording as needed</li>
        <li>Click "Stop" when finished, then download your recording</li>
      </ul>
      
      <h3>What This Tool Does</h3>
      <p>This browser-based screen recording tool captures your screen activity using the MediaRecorder API. It's perfect for:</p>
      <ul>
        <li>Creating software tutorials and demos</li>
        <li>Recording online meetings and webinars</li>
        <li>Capturing gameplay footage</li>
        <li>Creating educational content</li>
        <li>Recording bug reports for developers</li>
        <li>Making presentation videos</li>
      </ul>
      
      <h3>Other Useful Tools</h3>
      <p>Explore more helpful utilities in our toolbox:</p>
      <div class="tool-links">
        <a href="age-calculator.html" class="tool-link" aria-label="Age Calculator">
          <i class="fas fa-birthday-cake" aria-hidden="true"></i> Age Calculator
        </a>
        <a href="unit-converter.html" class="tool-link" aria-label="Unit Converter">
          <i class="fas fa-ruler-combined" aria-hidden="true"></i> Unit Converter
        </a>
        <a href="percentage-calculator.html" class="tool-link" aria-label="Percentage Calculator">
          <i class="fas fa-percentage" aria-hidden="true"></i> Percentage Calculator
        </a>
        <a href="index.html" class="tool-link" aria-label="All Tools">
          <i class="fas fa-tools" aria-hidden="true"></i> All Tools
        </a>
      </div>
    </section>

    <section class="content-section">
      <h2><i class="fas fa-question-circle" aria-hidden="true"></i> Frequently Asked Questions</h2>
      
      <div class="faq-item">
        <h3>How does the Screen Recorder work?</h3>
        <p>Our screen recorder uses the browser's MediaRecorder API to capture your screen and optional microphone audio. The recording happens entirely in your browser - no data is sent to our servers, ensuring your privacy.</p>
      </div>
      
      <div class="faq-item">
        <h3>What browsers support screen recording?</h3>
        <p>Most modern browsers support screen recording, including Chrome, Firefox, Edge, and Opera. Safari has limited support. For the best experience, we recommend using the latest version of Chrome.</p>
      </div>
      
      <div class="faq-item">
        <h3>Is this tool free to use?</h3>
        <p>Yes, our Online Screen Recorder is completely free to use with no registration required. You can use it as many times as you need without any limitations.</p>
      </div>
      
      <div class="faq-item">
        <h3>What video formats are supported?</h3>
        <p>The recorder supports WebM format by default, which offers excellent quality and compression. MP4 format is also available but may have limited browser support for recording.</p>
      </div>
      
      <div class="faq-item">
        <h3>Can I record system audio along with my screen?</h3>
        <p>Currently, our tool only supports recording microphone audio along with your screen. System audio recording requires additional browser permissions and extensions.</p>
      </div>
      
      <div class="faq-item">
        <h3>Where are my recordings stored?</h3>
        <p>All recordings are processed and stored temporarily in your browser's memory. Once you download the recording, it's saved to your device. We don't store any of your recordings on our servers.</p>
      </div>
    </section>
  </main>

  <footer>
    <div class="footer-content">
      <p>© 2025 Prabin's Toolbox | All Rights Reserved</p>
      <div class="footer-links">
        <a href="privacy-policy.html">Privacy Policy</a>
        <a href="terms-of-service.html">Terms of Service</a>
        <a href="contact.html">Contact Us</a>
      </div>
    </div>
  </footer>

  <script>
    // ---------- DOM ELEMENTS ----------
    const startBtn = document.getElementById('startBtn');
    const pauseBtn = document.getElementById('pauseBtn');
    const stopBtn = document.getElementById('stopBtn');
    const downloadBtn = document.getElementById('downloadBtn');
    const audioToggle = document.getElementById('audioToggle');
    const videoFormat = document.getElementById('videoFormat');
    const previewVideo = document.getElementById('previewVideo');
    const previewContainer = document.getElementById('previewContainer');
    const timer = document.getElementById('timer');
    const statusIndicator = document.getElementById('statusIndicator');

    // ---------- RECORDER STATE ----------
    let mediaRecorder;
    let recordedChunks = [];
    let stream;
    let startTime;
    let timerInterval;
    let pausedTime = 0;
    let isPaused = false;

    // ---------- INITIALIZATION ----------
    function initializeRecorder() {
      // Check if browser supports MediaRecorder API
      if (!navigator.mediaDevices || !navigator.mediaDevices.getDisplayMedia) {
        alert('Your browser does not support screen recording. Please try Chrome, Firefox, or Edge.');
        startBtn.disabled = true;
        return;
      }

      // Add event listeners
      startBtn.addEventListener('click', startRecording);
      pauseBtn.addEventListener('click', togglePause);
      stopBtn.addEventListener('click', stopRecording);
      downloadBtn.addEventListener('click', downloadRecording);
    }

    // ---------- START RECORDING ----------
    async function startRecording() {
      try {
        // Reset state
        recordedChunks = [];
        previewVideo.src = '';
        previewContainer.classList.remove('active');
        
        // Get screen stream
        const displayStream = await navigator.mediaDevices.getDisplayMedia({
          video: { cursor: 'always' },
          audio: false
        });

        let tracks = [displayStream.getVideoTracks()[0]];

        // Get microphone audio if enabled
        if (audioToggle.checked) {
          try {
            const audioStream = await navigator.mediaDevices.getUserMedia({ 
              audio: true 
            });
            tracks.push(audioStream.getAudioTracks()[0]);
          } catch (err) {
            console.warn('Microphone access denied, recording without audio');
          }
        }

        // Create combined stream
        stream = new MediaStream(tracks);

        // Set up MediaRecorder
        const mimeType = videoFormat.value === 'mp4' 
          ? 'video/mp4; codecs="avc1.42E01E, mp4a.40.2"'
          : 'video/webm; codecs=vp9,opus';

        mediaRecorder = new MediaRecorder(stream, { 
          mimeType: MediaRecorder.isTypeSupported(mimeType) ? mimeType : undefined
        });

        // Event handlers
        mediaRecorder.ondataavailable = (event) => {
          if (event.data.size > 0) {
            recordedChunks.push(event.data);
          }
        };

        mediaRecorder.onstop = () => {
          const blob = new Blob(recordedChunks, { 
            type: mediaRecorder.mimeType || 'video/webm'
          });
          const url = URL.createObjectURL(blob);
          previewVideo.src = url;
          previewContainer.classList.add('active');
          
          // Stop all tracks
          stream.getTracks().forEach(track => track.stop());
        };

        // Start recording
        mediaRecorder.start(1000); // Collect data every second
        startTime = Date.now();
        startTimer();
        
        // Update UI
        startBtn.disabled = true;
        pauseBtn.disabled = false;
        stopBtn.disabled = false;
        downloadBtn.disabled = true;
        audioToggle.disabled = true;
        videoFormat.disabled = true;
        
        updateStatus('recording', 'Recording in progress...');
        
        // Handle when user stops sharing screen
        displayStream.getVideoTracks()[0].addEventListener('ended', () => {
          stopRecording();
        });
        
      } catch (err) {
        console.error('Error starting recording:', err);
        alert('Failed to start recording: ' + err.message);
        resetUI();
      }
    }

    // ---------- TOGGLE PAUSE ----------
    function togglePause() {
      if (!mediaRecorder) return;
      
      if (mediaRecorder.state === 'recording') {
        mediaRecorder.pause();
        clearInterval(timerInterval);
        isPaused = true;
        pausedTime = Date.now();
        updateStatus('paused', 'Recording paused');
        pauseBtn.innerHTML = '<i class="fas fa-play" aria-hidden="true"></i> Resume';
      } else if (mediaRecorder.state === 'paused') {
        mediaRecorder.resume();
        startTimer(pausedTime - startTime);
        isPaused = false;
        updateStatus('recording', 'Recording in progress...');
        pauseBtn.innerHTML = '<i class="fas fa-pause" aria-hidden="true"></i> Pause';
      }
    }

    // ---------- STOP RECORDING ----------
    function stopRecording() {
      if (!mediaRecorder || mediaRecorder.state === 'inactive') return;
      
      mediaRecorder.stop();
      clearInterval(timerInterval);
      
      // Update UI
      startBtn.disabled = false;
      pauseBtn.disabled = true;
      stopBtn.disabled = true;
      downloadBtn.disabled = false;
      audioToggle.disabled = false;
      videoFormat.disabled = false;
      
      pauseBtn.innerHTML = '<i class="fas fa-pause" aria-hidden="true"></i> Pause';
      updateStatus('', 'Recording complete');
    }

    // ---------- DOWNLOAD RECORDING ----------
    function downloadRecording() {
      if (recordedChunks.length === 0) {
        alert('No recording available to download');
        return;
      }
      
      const blob = new Blob(recordedChunks, { 
        type: mediaRecorder.mimeType || 'video/webm'
      });
      const url = URL.createObjectURL(blob);
      const a = document.createElement('a');
      a.href = url;
      a.download = `screen-recording-${new Date().toISOString().slice(0, 19)}.${videoFormat.value}`;
      document.body.appendChild(a);
      a.click();
      document.body.removeChild(a);
      URL.revokeObjectURL(url);
    }

    // ---------- TIMER FUNCTIONS ----------
    function startTimer(offset = 0) {
      startTime = Date.now() - offset;
      clearInterval(timerInterval);
      timerInterval = setInterval(updateTimer, 1000);
      updateTimer();
    }

    function updateTimer() {
      if (isPaused) return;
      
      const elapsed = Date.now() - startTime;
      const hours = Math.floor(elapsed / 3600000);
      const minutes = Math.floor((elapsed % 3600000) / 60000);
      const seconds = Math.floor((elapsed % 60000) / 1000);
      
      timer.textContent = 
        `${hours.toString().padStart(2, '0')}:${minutes.toString().padStart(2, '0')}:${seconds.toString().padStart(2, '0')}`;
    }

    // ---------- STATUS INDICATOR ----------
    function updateStatus(status, text) {
      statusIndicator.className = 'status-indicator';
      if (status === 'recording') {
        statusIndicator.classList.add('recording');
        statusIndicator.innerHTML = '<i class="fas fa-circle" aria-hidden="true"></i> ' + text;
      } else if (status === 'paused') {
        statusIndicator.classList.add('paused');
        statusIndicator.innerHTML = '<i class="fas fa-pause-circle" aria-hidden="true"></i> ' + text;
      } else {
        statusIndicator.innerHTML = '<i class="fas fa-circle" aria-hidden="true"></i> ' + text;
      }
    }

    // ---------- RESET UI ----------
    function resetUI() {
      startBtn.disabled = false;
      pauseBtn.disabled = true;
      stopBtn.disabled = true;
      downloadBtn.disabled = true;
      audioToggle.disabled = false;
      videoFormat.disabled = false;
      pauseBtn.innerHTML = '<i class="fas fa-pause" aria-hidden="true"></i> Pause';
      clearInterval(timerInterval);
      timer.textContent = '00:00:00';
      updateStatus('', 'Ready to record');
    }

    // ---------- THEME TOGGLE ----------
    const themeToggle = document.getElementById("themeToggle");
    const prefersDarkScheme = window.matchMedia("(prefers-color-scheme: dark)");
    
    // Check for saved theme preference or use device preference
    const currentTheme = localStorage.getItem("theme") || 
                        (prefersDarkScheme.matches ? "dark" :  "light");
    
    if (currentTheme === "light") {
      document.body.classList.add("light-mode");
    }
    
    themeToggle.addEventListener("click", () => {
      document.body.classList.toggle("light-mode");
      
      // Save theme preference
      const theme = document.body.classList.contains("light-mode") ? "light" : "dark";
      localStorage.setItem("theme", theme);
    });
    
    themeToggle.addEventListener("keypress", (e) => {
      if (e.key === "Enter" || e.key === " ") {
        document.body.classList.toggle("light-mode");
        
        // Save theme preference
        const theme = document.body.classList.contains("light-mode") ? "light" : "dark";
        localStorage.setItem("theme", theme);
      }
    });

    // Initialize the recorder when the page loads
    document.addEventListener('DOMContentLoaded', initializeRecorder);
  </script>
</body>
</html>
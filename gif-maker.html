<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  
  <!-- SEO Meta Tags -->
  <title>Video to GIF Maker | Free Online GIF Creator - Prabin's Toolbox</title>
  <meta name="description" content="Convert videos to animated GIFs online for free with Prabin's Toolbox. Upload, select start/end, adjust frame rate, and download GIF instantly.">
  <meta name="keywords" content="video to gif, mp4 to gif, online gif maker, create gif from video, free video to gif, animated gif converter, browser-based gif creator">
  <meta name="author" content="Prabin's Toolbox">
  <link rel="canonical" href="https://www.prabinpokhrel1.com.np/video-to-gif.html">
  
  <!-- Open Graph Meta Tags -->
  <meta property="og:title" content="Video to GIF Maker | Free Online GIF Creator - Prabin's Toolbox">
  <meta property="og:description" content="Create GIFs from videos online quickly and privately. No signup, no uploads, 100% browser-based.">
  <meta property="og:image" content="https://www.prabinpokhrel1.com.np/assets/video-to-gif-preview.png">
  <meta property="og:url" content="https://www.prabinpokhrel1.com.np/video-to-gif.html">
  <meta property="og:type" content="website">
  <meta property="og:site_name" content="All-in-One Tools by Prabin">
  
  <!-- Twitter Card Meta Tags -->
  <meta name="twitter:card" content="summary_large_image">
  <meta name="twitter:title" content="Video to GIF Maker - Prabin's Toolbox">
  <meta name="twitter:description" content="Convert any video to GIF online. Preview, download, and share instantly.">
  <meta name="twitter:image" content="https://www.prabinpokhrel1.com.np/assets/video-to-gif-preview.png">
  <meta name="twitter:creator" content="@prabinpokhrel">
  
  <!-- Favicon -->
  <link rel="icon" href="/favicon.ico" type="image/x-icon">
  <link rel="shortcut icon" href="/favicon.ico" type="image/x-icon">
  
  <!-- Font Awesome -->
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
  
  <!-- FFmpeg.wasm -->
  <script src="https://unpkg.com/@ffmpeg/ffmpeg@0.11.6/dist/ffmpeg.min.js"></script>
  
  <!-- Structured Data -->
  <script type="application/ld+json">
  {
    "@context": "https://schema.org",
    "@type": "WebApplication",
    "name": "Video to GIF Maker",
    "description": "Convert videos to animated GIFs online for free with Prabin's Toolbox. Upload, select start/end, adjust frame rate, and download GIF instantly.",
    "url": "https://www.prabinpokhrel1.com.np/video-to-gif.html",
    "applicationCategory": "UtilityApplication",
    "operatingSystem": "Any",
    "permissions": "none",
    "offers": {
      "@type": "Offer",
      "price": "0",
      "priceCurrency": "USD"
    },
    "author": {
      "@type": "Person",
      "name": "Prabin Pokhrel"
    },
    "publisher": {
      "@type": "Organization",
      "name": "Prabin's Toolbox"
    }
  }
  </script>
   <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-7081789084626782"
     crossorigin="anonymous"></script>
  
  <style>
    /* --------- RESET & VARIABLES --------- */
    * { 
      margin: 0; 
      padding: 0; 
      box-sizing: border-box; 
      font-family: "Poppins", sans-serif; 
      transition: background-color 0.3s, color 0.3s;
    }

    :root {
      --primary: #38bdf8;
      --primary-dark: #0ea5e9;
      --secondary: #f472b6;
      --accent: #a78bfa;
      --bg: #0f172a;
      --bg-light: #1e293b;
      --bg-lighter: #334155;
      --text: #f1f5f9;
      --text-muted: #94a3b8;
      --card-bg: rgba(255, 255, 255, 0.05);
      --card-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -1px rgba(0, 0, 0, 0.06);
      --border: rgba(255, 255, 255, 0.1);
      --success: #10b981;
      --error: #ef4444;
    }

    .light-mode {
      --bg: #f8fafc;
      --bg-light: #e2e8f0;
      --bg-lighter: #cbd5e1;
      --text: #0f172a;
      --text-muted: #475569;
      --card-bg: rgba(255, 255, 255, 0.8);
      --card-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.05), 0 2px 4px -1px rgba(0, 0, 0, 0.03);
      --border: rgba(0, 0, 0, 0.1);
    }

    body {
      background: linear-gradient(135deg, var(--bg), var(--bg-light));
      color: var(--text);
      min-height: 100vh;
      display: flex;
      flex-direction: column;
      align-items: center;
      transition: background 0.5s ease;
      padding: 0 1rem;
    }

    /* --------- HEADER & NAVIGATION --------- */
    header {
      width: 100%;
      padding: 1.5rem 1rem;
      text-align: center;
      background: rgba(255, 255, 255, 0.05);
      backdrop-filter: blur(10px);
      border-bottom: 1px solid var(--border);
      position: relative;
      z-index: 100;
    }

    .header-content {
      max-width: 1200px;
      margin: 0 auto;
      display: flex;
      justify-content: space-between;
      align-items: center;
    }

    .logo {
      display: flex;
      align-items: center;
      gap: 10px;
    }

    .logo i {
      font-size: 2.5rem;
      color: var(--primary);
      animation: rotate 10s linear infinite;
    }

    @keyframes rotate {
      0% { transform: rotate(0deg); }
      100% { transform: rotate(360deg); }
    }

    .logo h1 {
      font-size: 2rem;
      color: var(--primary);
      letter-spacing: 1px;
    }

    .logo p {
      margin-top: 0.5rem;
      color: var(--text-muted);
      font-size: 1rem;
    }

    .theme-toggle {
      background: var(--card-bg);
      border: 1px solid var(--border);
      border-radius: 50px;
      width: 60px;
      height: 30px;
      position: relative;
      cursor: pointer;
      display: flex;
      align-items: center;
      padding: 0 5px;
      transition: all 0.3s ease;
    }

    .theme-toggle:hover {
      transform: scale(1.05);
    }

    .theme-toggle i {
      position: absolute;
      font-size: 1.2rem;
      transition: all 0.3s ease;
    }

    .theme-toggle .fa-sun {
      color: #f59e0b;
      opacity: 0;
    }

    .theme-toggle .fa-moon {
      color: #94a3b8;
    }

    .light-mode .theme-toggle .fa-sun {
      opacity: 1;
    }

    .light-mode .theme-toggle .fa-moon {
      opacity: 0;
    }

    .theme-toggle::after {
      content: '';
      position: absolute;
      width: 22px;
      height: 22px;
      border-radius: 50%;
      background: var(--primary);
      transition: all 0.3s ease;
      left: 4px;
    }

    .light-mode .theme-toggle::after {
      left: calc(100% - 26px);
      background: #f59e0b;
    }

    /* --------- MAIN CONTENT --------- */
    main {
      max-width: 1200px;
      width: 100%;
      margin: 2rem auto;
      padding: 0 1rem;
    }

    .tool-card {
      background: var(--card-bg);
      border-radius: 15px;
      padding: 2rem;
      box-shadow: var(--card-shadow);
      backdrop-filter: blur(10px);
      border: 1px solid var(--border);
      margin-bottom: 2rem;
      animation: fadeIn 0.8s ease;
    }

    @keyframes fadeIn {
      from { opacity: 0; transform: translateY(20px); }
      to { opacity: 1; transform: translateY(0); }
    }

    .card-header {
      text-align: center;
      margin-bottom: 2rem;
    }

    .card-header h1 {
      font-size: 1.8rem;
      color: var(--primary);
      margin-bottom: 0.5rem;
    }

    .card-header p {
      color: var(--text-muted);
    }

    .card-header i {
      font-size: 3rem;
      color: var(--primary);
      margin-bottom: 1rem;
    }

    /* --------- UPLOAD AREA --------- */
    .upload-area {
      border: 2px dashed var(--border);
      border-radius: 10px;
      padding: 3rem 2rem;
      text-align: center;
      cursor: pointer;
      transition: all 0.3s ease;
      margin-bottom: 2rem;
      background: var(--bg-light);
    }

    .upload-area:hover {
      border-color: var(--primary);
      background: var(--bg-lighter);
    }

    .upload-area.active {
      border-color: var(--success);
      background: rgba(16, 185, 129, 0.1);
    }

    .upload-icon {
      font-size: 3rem;
      color: var(--primary);
      margin-bottom: 1rem;
    }

    .upload-text h3 {
      font-size: 1.3rem;
      margin-bottom: 0.5rem;
      color: var(--text);
    }

    .upload-text p {
      color: var(--text-muted);
      margin-bottom: 1rem;
    }

    .upload-btn {
      display: inline-flex;
      align-items: center;
      gap: 0.5rem;
      padding: 0.8rem 1.5rem;
      background: var(--primary);
      color: white;
      border: none;
      border-radius: 8px;
      cursor: pointer;
      font-weight: 500;
      transition: all 0.3s ease;
    }

    .upload-btn:hover {
      background: var(--primary-dark);
      transform: translateY(-3px);
    }

    #fileInput {
      display: none;
    }

    .file-info {
      margin-top: 1rem;
      font-size: 0.9rem;
      color: var(--text-muted);
    }

    /* --------- VIDEO INFO SECTION --------- */
    .video-info-section {
      display: none;
      margin-bottom: 2rem;
    }

    .video-info-section.active {
      display: block;
      animation: fadeIn 0.5s ease;
    }

    .section-title {
      font-size: 1.3rem;
      color: var(--primary);
      margin-bottom: 1.5rem;
      display: flex;
      align-items: center;
      gap: 0.5rem;
    }

    .video-details {
      background: var(--bg-light);
      border-radius: 10px;
      padding: 1.5rem;
      border: 1px solid var(--border);
      margin-bottom: 1.5rem;
    }

    .video-details-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
      gap: 1.5rem;
    }

    .video-detail {
      display: flex;
      flex-direction: column;
      gap: 0.5rem;
    }

    .video-detail label {
      font-weight: 500;
      color: var(--text-muted);
      font-size: 0.9rem;
    }

    .video-detail span {
      color: var(--text);
      font-size: 1rem;
    }

    .video-preview {
      width: 100%;
      text-align: center;
    }

    .video-preview video {
      width: 100%;
      max-width: 500px;
      border-radius: 8px;
    }

    /* --------- TIMELINE SECTION --------- */
    .timeline-section {
      display: none;
      margin-bottom: 2rem;
    }

    .timeline-section.active {
      display: block;
      animation: fadeIn 0.5s ease;
    }

    .timeline-container {
      background: var(--bg-light);
      border-radius: 10px;
      padding: 1.5rem;
      border: 1px solid var(--border);
    }

    .timeline {
      height: 60px;
      background: var(--bg-lighter);
      border-radius: 8px;
      position: relative;
      margin-bottom: 1rem;
      overflow: hidden;
    }

    .timeline-waveform {
      width: 100%;
      height: 100%;
      display: flex;
      align-items: center;
      justify-content: space-between;
      padding: 0 10px;
    }

    .wave-bar {
      flex: 1;
      height: 40px;
      background: var(--primary);
      margin: 0 2px;
      border-radius: 2px;
      opacity: 0.7;
      animation: wave 1.5s ease-in-out infinite;
    }

    @keyframes wave {
      0%, 100% { transform: scaleY(0.7); }
      50% { transform: scaleY(1.2); }
    }

    .timeline-controls {
      position: absolute;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      pointer-events: none;
    }

    .timeline-start, .timeline-end {
      position: absolute;
      top: 0;
      width: 3px;
      height: 100%;
      background: var(--secondary);
      cursor: pointer;
      pointer-events: all;
    }

    .timeline-start::after, .timeline-end::after {
      content: '';
      position: absolute;
      top: -5px;
      left: -5px;
      width: 13px;
      height: 13px;
      background: var(--secondary);
      border-radius: 50%;
    }

    .timeline-start {
      left: 0%;
    }

    .timeline-end {
      left: 100%;
    }

    .selected-area {
      position: absolute;
      top: 0;
      left: 0%;
      width: 100%;
      height: 100%;
      background: rgba(56, 189, 248, 0.2);
      pointer-events: none;
    }

    .time-display {
      display: flex;
      justify-content: space-between;
      margin-bottom: 1rem;
    }

    .time-inputs {
      display: grid;
      grid-template-columns: 1fr 1fr;
      gap: 1rem;
    }

    .time-input-group {
      display: flex;
      flex-direction: column;
      gap: 0.5rem;
    }

    .time-input-group label {
      font-weight: 500;
      color: var(--text);
    }

    .time-input {
      display: flex;
      gap: 0.5rem;
    }

    .time-input input {
      flex: 1;
      padding: 0.8rem;
      border: 1px solid var(--border);
      border-radius: 8px;
      background: var(--bg-lighter);
      color: var(--text);
      text-align: center;
    }

    .time-unit {
      padding: 0.8rem;
      color: var(--text-muted);
    }

    /* --------- GIF SETTINGS SECTION --------- */
    .gif-settings-section {
      display: none;
      margin-bottom: 2rem;
    }

    .gif-settings-section.active {
      display: block;
      animation: fadeIn 0.5s ease;
    }

    .gif-settings-container {
      background: var(--bg-light);
      border-radius: 10px;
      padding: 1.5rem;
      border: 1px solid var(--border);
    }

    .gif-settings-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
      gap: 1.5rem;
      margin-bottom: 1.5rem;
    }

    .setting-group {
      display: flex;
      flex-direction: column;
      gap: 0.5rem;
    }

    .setting-group label {
      font-weight: 500;
      color: var(--text);
    }

    .setting-group select,
    .setting-group input {
      padding: 0.8rem;
      border: 1px solid var(--border);
      border-radius: 8px;
      background: var(--bg-lighter);
      color: var(--text);
    }

    .setting-group input[type="range"] {
      padding: 0;
    }

    .speed-presets {
      display: flex;
      flex-wrap: wrap;
      gap: 1rem;
      margin-top: 1rem;
    }

    .speed-preset {
      display: flex;
      flex-direction: column;
      align-items: center;
      padding: 1rem;
      background: var(--card-bg);
      border: 1px solid var(--border);
      border-radius: 8px;
      cursor: pointer;
      transition: all 0.3s ease;
      flex: 1;
      min-width: 120px;
    }

    .speed-preset:hover {
      background: var(--primary);
      transform: translateY(-3px);
    }

    .speed-preset.active {
      background: var(--primary);
      border-color: var(--primary);
    }

    .speed-preset i {
      font-size: 1.5rem;
      margin-bottom: 0.5rem;
    }

    .speed-preset span {
      font-size: 0.9rem;
      text-align: center;
    }

    .gif-preview {
      background: var(--bg-lighter);
      border-radius: 8px;
      padding: 1rem;
      margin-top: 1rem;
      text-align: center;
    }

    .gif-preview img {
      max-width: 100%;
      max-height: 200px;
      border-radius: 8px;
    }

    .gif-size-info {
      margin-top: 1rem;
      font-size: 0.9rem;
      color: var(--text-muted);
    }

    .action-buttons {
      display: flex;
      flex-wrap: wrap;
      gap: 1rem;
      justify-content: center;
      margin-top: 1.5rem;
    }

    .action-btn {
      display: inline-flex;
      align-items: center;
      gap: 0.5rem;
      padding: 1rem 1.5rem;
      background: var(--primary);
      color: white;
      border: none;
      border-radius: 8px;
      cursor: pointer;
      font-weight: 500;
      transition: all 0.3s ease;
    }

    .action-btn:hover {
      background: var(--primary-dark);
      transform: translateY(-3px);
    }

    .action-btn.secondary {
      background: var(--bg-light);
      color: var(--text);
    }

    .action-btn.secondary:hover {
      background: var(--bg-lighter);
    }

    /* --------- PROCESSING SECTION --------- */
    .processing-section {
      display: none;
      margin-bottom: 2rem;
      text-align: center;
    }

    .processing-section.active {
      display: block;
      animation: fadeIn 0.5s ease;
    }

    .progress-container {
      background: var(--bg-light);
      border-radius: 10px;
      padding: 2rem;
      border: 1px solid var(--border);
      margin-bottom: 1.5rem;
    }

    .progress-info {
      display: flex;
      justify-content: space-between;
      margin-bottom: 0.5rem;
    }

    .progress-label {
      font-weight: 500;
      color: var(--text);
    }

    .progress-percentage {
      color: var(--primary);
      font-weight: 600;
    }

    .progress-bar {
      height: 10px;
      background: var(--bg-lighter);
      border-radius: 5px;
      overflow: hidden;
    }

    .progress-fill {
      height: 100%;
      background: var(--primary);
      border-radius: 5px;
      width: 0%;
      transition: width 0.3s ease;
    }

    .processing-text {
      margin-top: 1rem;
      color: var(--text-muted);
      font-size: 0.9rem;
    }

    /* --------- RESULT SECTION --------- */
    .result-section {
      display: none;
      text-align: center;
    }

    .result-section.active {
      display: block;
      animation: fadeIn 0.5s ease;
    }

    .result-container {
      background: var(--bg-light);
      border-radius: 10px;
      padding: 2rem;
      border: 1px solid var(--border);
      margin-bottom: 1.5rem;
    }

    .result-preview {
      width: 100%;
      margin-bottom: 1.5rem;
    }

    .result-preview img {
      max-width: 100%;
      max-height: 300px;
      border-radius: 8px;
    }

    .gif-details {
      display: flex;
      justify-content: space-around;
      margin-top: 1rem;
    }

    .gif-detail {
      display: flex;
      flex-direction: column;
      align-items: center;
    }

    .gif-detail-label {
      font-size: 0.8rem;
      color: var(--text-muted);
    }

    .gif-detail-value {
      font-weight: 500;
      color: var(--text);
    }

    .download-buttons {
      display: flex;
      flex-wrap: wrap;
      gap: 1rem;
      justify-content: center;
      margin-top: 1.5rem;
    }

    .download-btn {
      display: inline-flex;
      align-items: center;
      gap: 0.5rem;
      padding: 1rem 1.5rem;
      background: var(--primary);
      color: white;
      border: none;
      border-radius: 8px;
      cursor: pointer;
      font-weight: 500;
      transition: all 0.3s ease;
    }

    .download-btn:hover {
      background: var(--primary-dark);
      transform: translateY(-3px);
    }

    .download-btn.secondary {
      background: var(--bg-light);
      color: var(--text);
    }

    .download-btn.secondary:hover {
      background: var(--bg-lighter);
    }

    /* --------- CONTENT SECTIONS --------- */
    .content-section {
      background: var(--card-bg);
      border-radius: 15px;
      padding: 2rem;
      box-shadow: var(--card-shadow);
      backdrop-filter: blur(10px);
      border: 1px solid var(--border);
      margin-bottom: 2rem;
    }

    .content-section h2 {
      font-size: 1.5rem;
      color: var(--primary);
      margin-bottom: 1rem;
      display: flex;
      align-items: center;
      gap: 0.5rem;
    }

    .content-section h3 {
      font-size: 1.2rem;
      color: var(--secondary);
      margin: 1.5rem 0 0.5rem;
    }

    .content-section p {
      color: var(--text);
      line-height: 1.6;
      margin-bottom: 1rem;
    }

    .content-section ul {
      padding-left: 1.5rem;
      margin-bottom: 1rem;
    }

    .content-section li {
      color: var(--text);
      line-height: 1.6;
      margin-bottom: 0.5rem;
    }

    .faq-item {
      margin-bottom: 1.5rem;
      border-bottom: 1px solid var(--border);
      padding-bottom: 1.5rem;
    }

    .faq-item:last-child {
      border-bottom: none;
      margin-bottom: 0;
    }

    .tool-links {
      display: flex;
      flex-wrap: wrap;
      gap: 1rem;
      margin-top: 1rem;
    }

    .tool-link {
      display: inline-flex;
      align-items: center;
      gap: 0.5rem;
      padding: 0.8rem 1.5rem;
      background: var(--card-bg);
      color: var(--text);
      border: 1px solid var(--border);
      border-radius: 10px;
      text-decoration: none;
      font-weight: 500;
      transition: all 0.3s ease;
    }

    .tool-link:hover {
      background: var(--primary);
      color: white;
      transform: translateY(-3px);
    }

    /* --------- BACK BUTTON --------- */
    .back-btn {
      display: inline-flex;
      align-items: center;
      gap: 0.5rem;
      padding: 0.8rem 1.5rem;
      background: var(--card-bg);
      color: var(--text);
      border: 1px solid var(--border);
      border-radius: 10px;
      text-decoration: none;
      font-weight: 500;
      transition: all 0.3s ease;
      margin-top: 1rem;
    }

    .back-btn:hover {
      background: var(--primary);
      color: white;
      transform: translateX(-5px);
    }

    /* --------- FOOTER --------- */
    footer {
      padding: 2rem 1rem;
      text-align: center;
      color: var(--text-muted);
      font-size: 0.9rem;
      border-top: 1px solid var(--border);
      width: 100%;
      margin-top: auto;
    }

    .footer-content {
      max-width: 1200px;
      margin: 0 auto;
      display: flex;
      flex-direction: column;
      align-items: center;
      gap: 1rem;
    }

    .footer-links {
      display: flex;
      gap: 2rem;
      margin-top: 1rem;
    }

    .footer-links a {
      color: var(--text-muted);
      text-decoration: none;
      transition: color 0.3s ease;
    }

    .footer-links a:hover {
      color: var(--primary);
    }

    /* --------- RESPONSIVE DESIGN --------- */
    @media (max-width: 768px) {
      .header-content {
        flex-direction: column;
        gap: 1rem;
      }

      .video-details-grid {
        grid-template-columns: 1fr;
      }

      .time-inputs {
        grid-template-columns: 1fr;
      }

      .gif-settings-grid {
        grid-template-columns: 1fr;
      }

      .speed-presets {
        flex-direction: column;
      }

      .action-buttons {
        flex-direction: column;
        align-items: center;
      }

      .action-btn {
        width: 100%;
        max-width: 300px;
      }

      .download-buttons {
        flex-direction: column;
        align-items: center;
      }

      .download-btn {
        width: 100%;
        max-width: 300px;
      }
    }

    @media (max-width: 480px) {
      .footer-links {
        flex-direction: column;
        gap: 1rem;
      }
    }
  </style>
</head>
<body>
  <header>
    <div class="header-content">
      <div class="logo">
        <i class="fas fa-toolbox" aria-hidden="true"></i>
        <div>
          <h1>All-in-One Tools</h1>
          <p>50+ useful tools for your everyday needs</p>
        </div>
      </div>
      <div class="theme-toggle" id="themeToggle" aria-label="Toggle dark/light mode" role="button" tabindex="0">
        <i class="fas fa-sun" aria-hidden="true"></i>
        <i class="fas fa-moon" aria-hidden="true"></i>
      </div>
    </div>
  </header>

  <main>
    <article>
      <div class="tool-card">
        <div class="card-header">
          <i class="fas fa-film" aria-hidden="true"></i>
          <h1>Video to GIF Maker</h1>
          <p>Convert your videos into animated GIFs instantly</p>
        </div>

        <!-- Upload Section -->
        <div class="upload-area" id="uploadArea">
          <div class="upload-icon">
            <i class="fas fa-cloud-upload-alt"></i>
          </div>
          <div class="upload-text">
            <h3>Upload Your Video</h3>
            <p>Drag & drop your video file here or click to browse</p>
            <p class="file-info">Supports: MP4, WebM, MOV, AVI (Max: 50MB)</p>
          </div>
          <button class="upload-btn" id="uploadBtn">
            <i class="fas fa-folder-open"></i> Choose Video File
          </button>
          <input type="file" id="fileInput" accept=".mp4,.webm,.mov,.avi,.mkv">
        </div>

        <!-- Video Info Section -->
        <div class="video-info-section" id="videoInfoSection">
          <h2 class="section-title">
            <i class="fas fa-info-circle"></i> Video Details
          </h2>
          <div class="video-details">
            <div class="video-details-grid">
              <div class="video-detail">
                <label>File Name</label>
                <span id="fileName">-</span>
              </div>
              <div class="video-detail">
                <label>File Size</label>
                <span id="fileSize">-</span>
              </div>
              <div class="video-detail">
                <label>Duration</label>
                <span id="fileDuration">-</span>
              </div>
              <div class="video-detail">
                <label>Format</label>
                <span id="fileFormat">-</span>
              </div>
            </div>
          </div>
          <div class="video-preview">
            <video id="videoPreview" controls>
              Your browser does not support the video element.
            </video>
          </div>
        </div>

        <!-- Timeline Section -->
        <div class="timeline-section" id="timelineSection">
          <h2 class="section-title">
            <i class="fas fa-sliders-h"></i> Select GIF Duration
          </h2>
          <div class="timeline-container">
            <div class="timeline">
              <div class="timeline-waveform" id="timelineWaveform">
                <!-- Waveform bars will be generated by JavaScript -->
              </div>
              <div class="timeline-controls">
                <div class="selected-area" id="selectedArea"></div>
                <div class="timeline-start" id="timelineStart"></div>
                <div class="timeline-end" id="timelineEnd"></div>
              </div>
            </div>
            <div class="time-display">
              <span id="startTimeDisplay">00:00</span>
              <span id="endTimeDisplay">00:00</span>
            </div>
            <div class="time-inputs">
              <div class="time-input-group">
                <label for="startTime">Start Time</label>
                <div class="time-input">
                  <input type="number" id="startMinutes" min="0" value="0" max="59">
                  <span class="time-unit">:</span>
                  <input type="number" id="startSeconds" min="0" value="0" max="59">
                </div>
              </div>
              <div class="time-input-group">
                <label for="endTime">End Time</label>
                <div class="time-input">
                  <input type="number" id="endMinutes" min="0" value="0" max="59">
                  <span class="time-unit">:</span>
                  <input type="number" id="endSeconds" min="0" value="0" max="59">
                </div>
              </div>
            </div>
          </div>
        </div>

        <!-- GIF Settings Section -->
        <div class="gif-settings-section" id="gifSettingsSection">
          <h2 class="section-title">
            <i class="fas fa-cog"></i> GIF Settings
          </h2>
          <div class="gif-settings-container">
            <div class="gif-settings-grid">
              <div class="setting-group">
                <label for="frameRate">Frame Rate</label>
                <select id="frameRate">
                  <option value="5">5 FPS (Smaller file)</option>
                  <option value="10" selected>10 FPS (Balanced)</option>
                  <option value="15">15 FPS (Smoother)</option>
                  <option value="24">24 FPS (Cinematic)</option>
                </select>
              </div>
              <div class="setting-group">
                <label for="gifQuality">GIF Quality</label>
                <select id="gifQuality">
                  <option value="low">Low (Smaller file)</option>
                  <option value="medium" selected>Medium (Balanced)</option>
                  <option value="high">High (Better quality)</option>
                </select>
              </div>
              <div class="setting-group">
                <label for="gifSize">GIF Size</label>
                <select id="gifSize">
                  <option value="original">Original Size</option>
                  <option value="large">Large (800px width)</option>
                  <option value="medium" selected>Medium (500px width)</option>
                  <option value="small">Small (300px width)</option>
                  <option value="tiny">Tiny (200px width)</option>
                </select>
              </div>
            </div>

            <div class="speed-presets">
              <div class="speed-preset" data-speed="slow">
                <i class="fas fa-tachometer-alt-slow"></i>
                <span>Slow Motion</span>
                <small>50% speed</small>
              </div>
              <div class="speed-preset active" data-speed="normal">
                <i class="fas fa-tachometer-alt"></i>
                <span>Normal Speed</span>
                <small>100% speed</small>
              </div>
              <div class="speed-preset" data-speed="fast">
                <i class="fas fa-tachometer-alt-fast"></i>
                <span>Fast Motion</span>
                <small>200% speed</small>
              </div>
            </div>

            <div class="gif-preview" id="gifPreview">
              <p>Your GIF preview will appear here</p>
            </div>

            <div class="gif-size-info" id="gifSizeInfo">
              Estimated GIF size: <span id="estimatedGifSize">-</span>
            </div>

            <div class="action-buttons">
              <button class="action-btn" id="previewGifBtn">
                <i class="fas fa-eye"></i> Preview GIF
              </button>
              <button class="action-btn secondary" id="createGifBtn">
                <i class="fas fa-magic"></i> Create GIF
              </button>
            </div>
          </div>
        </div>

        <!-- Processing Section -->
        <div class="processing-section" id="processingSection">
          <h2 class="section-title">
            <i class="fas fa-sync fa-spin"></i> Creating GIF
          </h2>
          <div class="progress-container">
            <div class="progress-info">
              <span class="progress-label">Conversion Progress</span>
              <span class="progress-percentage" id="progressPercentage">0%</span>
            </div>
            <div class="progress-bar">
              <div class="progress-fill" id="progressFill"></div>
            </div>
            <p class="processing-text" id="processingText">Initializing FFmpeg...</p>
          </div>
        </div>

        <!-- Result Section -->
        <div class="result-section" id="resultSection">
          <h2 class="section-title">
            <i class="fas fa-check-circle"></i> GIF Created Successfully
          </h2>
          <div class="result-container">
            <div class="result-preview">
              <img id="gifResult" src="" alt="Your created GIF">
            </div>
            <div class="gif-details">
              <div class="gif-detail">
                <span class="gif-detail-label">File Size</span>
                <span class="gif-detail-value" id="gifFileSize">-</span>
              </div>
              <div class="gif-detail">
                <span class="gif-detail-label">Dimensions</span>
                <span class="gif-detail-value" id="gifDimensions">-</span>
              </div>
              <div class="gif-detail">
                <span class="gif-detail-label">Duration</span>
                <span class="gif-detail-value" id="gifDuration">-</span>
              </div>
            </div>
            <p>Your GIF is ready! You can download it or create another one.</p>
          </div>
          <div class="download-buttons">
            <button class="download-btn" id="downloadBtn">
              <i class="fas fa-download"></i> Download GIF
            </button>
            <button class="download-btn secondary" id="createAnotherBtn">
              <i class="fas fa-redo"></i> Create Another GIF
            </button>
          </div>
        </div>

        <a href="index.html" class="back-btn">
          <i class="fas fa-arrow-left" aria-hidden="true"></i> Back to Home
        </a>
      </div>
    </article>

    <section class="content-section">
      <h2><i class="fas fa-info-circle" aria-hidden="true"></i> About This Video to GIF Maker</h2>
      <p>Our Free Video to GIF Maker is a powerful online tool that allows you to convert video clips into animated GIFs with ease. Whether you want to create reaction GIFs, memes, or share moments from videos, this tool makes the process simple and efficient.</p>
      
      <h3>How to Use the Video to GIF Maker</h3>
      <p>Creating your GIF is simple:</p>
      <ul>
        <li>Upload your video file by dragging and dropping or using the file browser</li>
        <li>Use the timeline or time inputs to select the exact portion you want to convert</li>
        <li>Adjust GIF settings like frame rate, quality, and size</li>
        <li>Preview your GIF before creating the final version</li>
        <li>Click "Create GIF" to generate your animated GIF</li>
        <li>Download your GIF and share it with others</li>
      </ul>
      
      <h3>Key Features</h3>
      <p>Our video to GIF maker offers a comprehensive set of features:</p>
      <ul>
        <li><strong>Precise Trimming:</strong> Select exact start and end times for your GIF</li>
        <li><strong>Customizable Frame Rate:</strong> Choose from 5 to 24 frames per second</li>
        <li><strong>Quality Settings:</strong> Optimize for file size or visual quality</li>
        <li><strong>Size Options:</strong> Create GIFs from 200px to original size</li>
        <li><strong>Speed Control:</strong> Slow down or speed up your GIF</li>
        <li><strong>Live Preview:</strong> See how your GIF will look before creating it</li>
        <li><strong>Privacy Focused:</strong> All processing happens in your browser - no server uploads</li>
      </ul>
      
      <h3>Other Useful Tools</h3>
      <p>Explore more helpful utilities in our toolbox:</p>
      <div class="tool-links">
        <a href="video-compressor.html" class="tool-link" aria-label="Video Compressor">
          <i class="fas fa-compress-alt" aria-hidden="true"></i> Video Compressor
        </a>
        <a href="audio-cutter.html" class="tool-link" aria-label="Audio Cutter">
          <i class="fas fa-cut" aria-hidden="true"></i> Audio Cutter
        </a>
        <a href="video-to-mp3.html" class="tool-link" aria-label="Video to MP3">
          <i class="fas fa-file-audio" aria-hidden="true"></i> Video to MP3
        </a>
        <a href="index.html" class="tool-link" aria-label="All Tools">
          <i class="fas fa-tools" aria-hidden="true"></i> All Tools
        </a>
      </div>
    </section>

    <section class="content-section">
      <h2><i class="fas fa-question-circle" aria-hidden="true"></i> Frequently Asked Questions</h2>
      
      <div class="faq-item">
        <h3>What video formats can I convert to GIF?</h3>
        <p>You can upload MP4, WebM, MOV, and AVI video files. The tool will process them in your browser and convert the selected portion to an animated GIF.</p>
      </div>
      
      <div class="faq-item">
        <h3>Is there a file size limit for uploaded videos?</h3>
        <p>The maximum file size for uploads is 50MB. For best results, we recommend using videos that are under 2 minutes in length for faster GIF creation.</p>
      </div>
      
      <div class="faq-item">
        <h3>How long does it take to create a GIF?</h3>
        <p>GIF creation time depends on the length of the selected portion and your chosen settings. A typical 5-second clip takes about 10-30 seconds to convert.</p>
      </div>
      
      <div class="faq-item">
        <h3>Can I adjust the speed of my GIF?</h3>
        <p>Yes, you can choose between slow motion (50% speed), normal speed, or fast motion (200% speed) using the speed presets.</p>
      </div>
      
      <div class="faq-item">
        <h3>Are my videos uploaded to a server?</h3>
        <p>No, all video processing happens directly in your browser using FFmpeg.wasm. Your videos are never uploaded to any server, ensuring complete privacy and security.</p>
      </div>
    </section>
  </main>

  <footer>
    <div class="footer-content">
      <p>Â© 2025 Prabin's Toolbox | All Rights Reserved</p>
      <div class="footer-links">
        <a href="privacy-policy.html">Privacy Policy</a>
        <a href="terms-of-service.html">Terms of Service</a>
        <a href="contact.html">Contact Us</a>
      </div>
    </div>
  </footer>

  <script>
    // ---------- DOM ELEMENTS ----------
    const uploadArea = document.getElementById('uploadArea');
    const uploadBtn = document.getElementById('uploadBtn');
    const fileInput = document.getElementById('fileInput');
    const videoInfoSection = document.getElementById('videoInfoSection');
    const timelineSection = document.getElementById('timelineSection');
    const gifSettingsSection = document.getElementById('gifSettingsSection');
    const processingSection = document.getElementById('processingSection');
    const resultSection = document.getElementById('resultSection');
    const fileName = document.getElementById('fileName');
    const fileSize = document.getElementById('fileSize');
    const fileDuration = document.getElementById('fileDuration');
    const fileFormat = document.getElementById('fileFormat');
    const videoPreview = document.getElementById('videoPreview');
    const timelineWaveform = document.getElementById('timelineWaveform');
    const timelineStart = document.getElementById('timelineStart');
    const timelineEnd = document.getElementById('timelineEnd');
    const selectedArea = document.getElementById('selectedArea');
    const startTimeDisplay = document.getElementById('startTimeDisplay');
    const endTimeDisplay = document.getElementById('endTimeDisplay');
    const startMinutes = document.getElementById('startMinutes');
    const startSeconds = document.getElementById('startSeconds');
    const endMinutes = document.getElementById('endMinutes');
    const endSeconds = document.getElementById('endSeconds');
    const gifPreview = document.getElementById('gifPreview');
    const estimatedGifSize = document.getElementById('estimatedGifSize');
    const previewGifBtn = document.getElementById('previewGifBtn');
    const createGifBtn = document.getElementById('createGifBtn');
    const progressPercentage = document.getElementById('progressPercentage');
    const progressFill = document.getElementById('progressFill');
    const processingText = document.getElementById('processingText');
    const gifResult = document.getElementById('gifResult');
    const gifFileSize = document.getElementById('gifFileSize');
    const gifDimensions = document.getElementById('gifDimensions');
    const gifDuration = document.getElementById('gifDuration');
    const downloadBtn = document.getElementById('downloadBtn');
    const createAnotherBtn = document.getElementById('createAnotherBtn');
    const frameRate = document.getElementById('frameRate');
    const gifQuality = document.getElementById('gifQuality');
    const gifSize = document.getElementById('gifSize');
    const speedPresets = document.querySelectorAll('.speed-preset');

    // ---------- VARIABLES ----------
    let uploadedFile = null;
    let videoDuration = 0;
    let startTime = 0;
    let endTime = 0;
    let gifUrl = null;
    let ffmpeg = null;
    let isFFmpegLoaded = false;
    let isDraggingStart = false;
    let isDraggingEnd = false;

    // ---------- EVENT LISTENERS ----------
    function initializeEventListeners() {
      // Upload button click
      uploadBtn.addEventListener('click', () => fileInput.click());
      
      // File input change
      fileInput.addEventListener('change', handleFileUpload);
      
      // Drag and drop
      uploadArea.addEventListener('dragover', (e) => {
        e.preventDefault();
        uploadArea.classList.add('active');
      });
      
      uploadArea.addEventListener('dragleave', () => {
        uploadArea.classList.remove('active');
      });
      
      uploadArea.addEventListener('drop', (e) => {
        e.preventDefault();
        uploadArea.classList.remove('active');
        
        if (e.dataTransfer.files.length) {
          fileInput.files = e.dataTransfer.files;
          handleFileUpload();
        }
      });
      
      // Timeline controls
      timelineStart.addEventListener('mousedown', () => isDraggingStart = true);
      timelineEnd.addEventListener('mousedown', () => isDraggingEnd = true);
      
      document.addEventListener('mousemove', handleTimelineDrag);
      document.addEventListener('mouseup', () => {
        isDraggingStart = false;
        isDraggingEnd = false;
      });
      
      // Touch events for mobile
      timelineStart.addEventListener('touchstart', () => isDraggingStart = true);
      timelineEnd.addEventListener('touchstart', () => isDraggingEnd = true);
      
      document.addEventListener('touchmove', handleTimelineDrag);
      document.addEventListener('touchend', () => {
        isDraggingStart = false;
        isDraggingEnd = false;
      });
      
      // Time inputs
      startMinutes.addEventListener('input', updateFromTimeInputs);
      startSeconds.addEventListener('input', updateFromTimeInputs);
      endMinutes.addEventListener('input', updateFromTimeInputs);
      endSeconds.addEventListener('input', updateFromTimeInputs);
      
      // Speed presets
      speedPresets.forEach(preset => {
        preset.addEventListener('click', () => {
          speedPresets.forEach(p => p.classList.remove('active'));
          preset.classList.add('active');
        });
      });
      
      // Settings changes
      frameRate.addEventListener('change', updateGifEstimate);
      gifQuality.addEventListener('change', updateGifEstimate);
      gifSize.addEventListener('change', updateGifEstimate);
      
      // Action buttons
      previewGifBtn.addEventListener('click', previewGif);
      createGifBtn.addEventListener('click', createGif);
      
      // Download buttons
      downloadBtn.addEventListener('click', downloadGif);
      createAnotherBtn.addEventListener('click', resetGifMaker);
      
      // Initialize FFmpeg
      initializeFFmpeg();
    }

    // ---------- FILE UPLOAD ----------
    function handleFileUpload() {
      const file = fileInput.files[0];
      
      if (!file) return;
      
      // Check file type
      const validTypes = ['video/mp4', 'video/webm', 'video/quicktime', 'video/x-msvideo', 'video/x-matroska'];
      if (!validTypes.includes(file.type)) {
        alert('Please upload a valid video file (MP4, WebM, MOV, AVI, or MKV).');
        return;
      }
      
      // Check file size (50MB max)
      if (file.size > 50 * 1024 * 1024) {
        alert('File size must be less than 50MB.');
        return;
      }
      
      uploadedFile = file;
      
      // Get video duration
      getVideoDuration(file).then(duration => {
        videoDuration = duration;
        endTime = Math.min(duration, 10); // Default to first 10 seconds or full duration if shorter
        
        // Update file info
        updateFileInfo(file, duration);
        
        // Set up timeline
        setupTimeline(duration);
        
        // Show video info and timeline sections
        videoInfoSection.classList.add('active');
        timelineSection.classList.add('active');
        gifSettingsSection.classList.add('active');
        
        // Update upload area text
        const uploadText = uploadArea.querySelector('.upload-text h3');
        uploadText.textContent = 'Video Uploaded Successfully!';
        uploadArea.querySelector('.upload-text p').textContent = 'Your video is ready for GIF creation';
        
        // Update GIF estimate
        updateGifEstimate();
      }).catch(error => {
        console.error('Error getting video duration:', error);
        // Still show the file info with unknown duration
        updateFileInfo(file, 0);
        videoInfoSection.classList.add('active');
        timelineSection.classList.add('active');
        gifSettingsSection.classList.add('active');
        
        const uploadText = uploadArea.querySelector('.upload-text h3');
        uploadText.textContent = 'Video Uploaded Successfully!';
        uploadArea.querySelector('.upload-text p').textContent = 'Your video is ready for GIF creation';
      });
    }

    function getVideoDuration(file) {
      return new Promise((resolve, reject) => {
        const video = document.createElement('video');
        video.preload = 'metadata';
        
        video.onloadedmetadata = function() {
          window.URL.revokeObjectURL(video.src);
          resolve(video.duration);
        };
        
        video.onerror = function() {
          reject(new Error('Failed to load video metadata'));
        };
        
        video.src = URL.createObjectURL(file);
      });
    }

    function updateFileInfo(file, duration) {
      fileName.textContent = file.name;
      fileSize.textContent = formatFileSize(file.size);
      fileDuration.textContent = formatDuration(duration);
      fileFormat.textContent = file.type.split('/')[1].toUpperCase();
      
      // Set video preview source
      videoPreview.src = URL.createObjectURL(file);
    }

    function formatFileSize(bytes) {
      if (bytes === 0) return '0 Bytes';
      
      const k = 1024;
      const sizes = ['Bytes', 'KB', 'MB', 'GB'];
      const i = Math.floor(Math.log(bytes) / Math.log(k));
      
      return parseFloat((bytes / Math.pow(k, i)).toFixed(2)) + ' ' + sizes[i];
    }

    function formatDuration(seconds) {
      if (seconds === 0) return 'Unknown';
      
      const mins = Math.floor(seconds / 60);
      const secs = Math.floor(seconds % 60);
      return `${mins}:${secs < 10 ? '0' : ''}${secs}`;
    }

    // ---------- TIMELINE FUNCTIONS ----------
    function setupTimeline(duration) {
      // Generate waveform bars (simulated)
      timelineWaveform.innerHTML = '';
      for (let i = 0; i < 50; i++) {
        const bar = document.createElement('div');
        bar.className = 'wave-bar';
        bar.style.height = `${Math.random() * 30 + 20}px`;
        timelineWaveform.appendChild(bar);
      }
      
      // Set initial timeline positions
      updateTimelineFromTimes(0, endTime);
    }

    function handleTimelineDrag(e) {
      if (!isDraggingStart && !isDraggingEnd) return;
      
      const timelineRect = timelineWaveform.getBoundingClientRect();
      const clientX = e.clientX || (e.touches && e.touches[0].clientX);
      
      if (!clientX) return;
      
      const position = (clientX - timelineRect.left) / timelineRect.width;
      const time = Math.max(0, Math.min(videoDuration, position * videoDuration));
      
      if (isDraggingStart) {
        startTime = Math.min(time, endTime - 0.1); // Ensure start is before end
        updateTimelineFromTimes(startTime, endTime);
      } else if (isDraggingEnd) {
        endTime = Math.max(time, startTime + 0.1); // Ensure end is after start
        updateTimelineFromTimes(startTime, endTime);
      }
      
      // Update GIF estimate when timeline changes
      updateGifEstimate();
    }

    function updateTimelineFromTimes(start, end) {
      const startPercent = (start / videoDuration) * 100;
      const endPercent = (end / videoDuration) * 100;
      
      timelineStart.style.left = `${startPercent}%`;
      timelineEnd.style.left = `${endPercent}%`;
      selectedArea.style.left = `${startPercent}%`;
      selectedArea.style.width = `${endPercent - startPercent}%`;
      
      // Update time displays
      startTimeDisplay.textContent = formatTime(start);
      endTimeDisplay.textContent = formatTime(end);
      
      // Update time inputs
      const startMins = Math.floor(start / 60);
      const startSecs = Math.floor(start % 60);
      const endMins = Math.floor(end / 60);
      const endSecs = Math.floor(end % 60);
      
      startMinutes.value = startMins;
      startSeconds.value = startSecs;
      endMinutes.value = endMins;
      endSeconds.value = endSecs;
    }

    function updateFromTimeInputs() {
      const startMins = parseInt(startMinutes.value) || 0;
      const startSecs = parseInt(startSeconds.value) || 0;
      const endMins = parseInt(endMinutes.value) || 0;
      const endSecs = parseInt(endSeconds.value) || 0;
      
      startTime = Math.min(startMins * 60 + startSecs, videoDuration);
      endTime = Math.min(endMins * 60 + endSecs, videoDuration);
      
      // Ensure start is before end
      if (startTime >= endTime) {
        startTime = Math.max(0, endTime - 1);
      }
      
      updateTimelineFromTimes(startTime, endTime);
      updateGifEstimate();
    }

    function formatTime(seconds) {
      const mins = Math.floor(seconds / 60);
      const secs = Math.floor(seconds % 60);
      return `${mins}:${secs < 10 ? '0' : ''}${secs}`;
    }

    // ---------- GIF ESTIMATION ----------
    function updateGifEstimate() {
      if (!uploadedFile || startTime >= endTime) return;
      
      const duration = endTime - startTime;
      const frameRateValue = parseInt(frameRate.value);
      const qualityValue = gifQuality.value;
      const sizeValue = gifSize.value;
      
      // Calculate base size based on duration and frame rate
      let estimatedSizeKB = duration * frameRateValue * 10; // Rough estimate
      
      // Adjust for quality
      switch (qualityValue) {
        case 'low':
          estimatedSizeKB *= 0.7;
          break;
        case 'high':
          estimatedSizeKB *= 1.5;
          break;
        // medium is default
      }
      
      // Adjust for size
      switch (sizeValue) {
        case 'large':
          estimatedSizeKB *= 1.5;
          break;
        case 'small':
          estimatedSizeKB *= 0.7;
          break;
        case 'tiny':
          estimatedSizeKB *= 0.4;
          break;
        // original and medium are default
      }
      
      estimatedGifSize.textContent = `${Math.round(estimatedSizeKB)} KB`;
    }

    // ---------- FFMPEG INITIALIZATION ----------
    async function initializeFFmpeg() {
      try {
        processingText.textContent = 'Loading FFmpeg...';
        
        // Create FFmpeg instance
        ffmpeg = new FFmpeg();
        
        // Load FFmpeg
        await ffmpeg.load();
        
        isFFmpegLoaded = true;
        processingText.textContent = 'FFmpeg loaded successfully!';
        
        console.log('FFmpeg loaded successfully');
      } catch (error) {
        console.error('Error loading FFmpeg:', error);
        processingText.textContent = 'Failed to load FFmpeg. Please refresh the page.';
      }
    }

    // ---------- GIF CREATION ----------
    async function previewGif() {
      if (!uploadedFile || !isFFmpegLoaded) {
        alert('Please upload a video file and wait for FFmpeg to load.');
        return;
      }
      
      if (startTime >= endTime) {
        alert('Please select a valid time range (start time must be before end time).');
        return;
      }
      
      // Show processing section
      processingSection.classList.add('active');
      gifSettingsSection.classList.remove('active');
      
      try {
        // Reset progress
        updateProgress(0, 'Creating GIF preview...');
        
        // Write the video file to FFmpeg's virtual file system
        const inputName = 'input.' + uploadedFile.name.split('.').pop();
        const outputName = 'preview.gif';
        
        const data = await uploadedFile.arrayBuffer();
        await ffmpeg.writeFile(inputName, new Uint8Array(data));
        
        updateProgress(20, 'Processing video...');
        
        // Build FFmpeg command for GIF creation
        const duration = endTime - startTime;
        const frameRateValue = parseInt(frameRate.value);
        const sizeValue = gifSize.value;
        
        let ffmpegArgs = [
          '-i', inputName,
          '-ss', startTime.toString(),
          '-t', duration.toString(),
          '-vf', `fps=${frameRateValue},scale=${getGifSizeValue(sizeValue)}:-1:flags=lanczos`,
          '-f', 'gif'
        ];
        
        ffmpegArgs.push(outputName);
        
        updateProgress(50, 'Converting to GIF...');
        
        // Execute FFmpeg command
        await ffmpeg.exec(ffmpegArgs);
        
        updateProgress(80, 'Finalizing GIF...');
        
        // Read the output file
        const outputData = await ffmpeg.readFile(outputName);
        
        updateProgress(95, 'Creating preview...');
        
        // Create blob URL for the GIF
        const gifBlob = new Blob([outputData.buffer], { type: 'image/gif' });
        const gifUrl = URL.createObjectURL(gifBlob);
        
        // Show preview
        gifPreview.innerHTML = '';
        const previewImg = document.createElement('img');
        previewImg.src = gifUrl;
        previewImg.alt = 'GIF Preview';
        gifPreview.appendChild(previewImg);
        
        updateProgress(100, 'Preview created!');
        
        // Show settings section after a short delay
        setTimeout(() => {
          processingSection.classList.remove('active');
          gifSettingsSection.classList.add('active');
        }, 1000);
        
      } catch (error) {
        console.error('Preview error:', error);
        updateProgress(0, `Preview failed: ${error.message}`);
        alert('GIF preview failed. Please try again with a different video or settings.');
      }
    }

    async function createGif() {
      if (!uploadedFile || !isFFmpegLoaded) {
        alert('Please upload a video file and wait for FFmpeg to load.');
        return;
      }
      
      if (startTime >= endTime) {
        alert('Please select a valid time range (start time must be before end time).');
        return;
      }
      
      // Show processing section
      processingSection.classList.add('active');
      gifSettingsSection.classList.remove('active');
      
      try {
        // Reset progress
        updateProgress(0, 'Creating your GIF...');
        
        // Write the video file to FFmpeg's virtual file system
        const inputName = 'input.' + uploadedFile.name.split('.').pop();
        const outputName = 'output.gif';
        
        const data = await uploadedFile.arrayBuffer();
        await ffmpeg.writeFile(inputName, new Uint8Array(data));
        
        updateProgress(20, 'Processing video...');
        
        // Build FFmpeg command for GIF creation
        const duration = endTime - startTime;
        const frameRateValue = parseInt(frameRate.value);
        const sizeValue = gifSize.value;
        const qualityValue = gifQuality.value;
        
        let ffmpegArgs = [
          '-i', inputName,
          '-ss', startTime.toString(),
          '-t', duration.toString(),
          '-vf', `fps=${frameRateValue},scale=${getGifSizeValue(sizeValue)}:-1:flags=lanczos`
        ];
        
        // Add quality settings
        if (qualityValue === 'low') {
          ffmpegArgs.push('-compression_level', '3');
        } else if (qualityValue === 'high') {
          ffmpegArgs.push('-compression_level', '1');
        }
        
        ffmpegArgs.push('-f', 'gif', outputName);
        
        updateProgress(50, 'Converting to GIF...');
        
        // Execute FFmpeg command
        await ffmpeg.exec(ffmpegArgs);
        
        updateProgress(80, 'Optimizing GIF...');
        
        // Read the output file
        const outputData = await ffmpeg.readFile(outputName);
        
        updateProgress(95, 'Finalizing...');
        
        // Create blob URL for the GIF
        const gifBlob = new Blob([outputData.buffer], { type: 'image/gif' });
        gifUrl = URL.createObjectURL(gifBlob);
        
        // Set result GIF source
        gifResult.src = gifUrl;
        
        // Update GIF details
        gifFileSize.textContent = formatFileSize(gifBlob.size);
        gifDimensions.textContent = `${getGifSizeValue(sizeValue)}px`;
        gifDuration.textContent = formatDuration(duration);
        
        updateProgress(100, 'GIF created successfully!');
        
        // Show result section after a short delay
        setTimeout(() => {
          processingSection.classList.remove('active');
          resultSection.classList.add('active');
        }, 1000);
        
      } catch (error) {
        console.error('GIF creation error:', error);
        updateProgress(0, `GIF creation failed: ${error.message}`);
        alert('GIF creation failed. Please try again with a different video or settings.');
      }
    }

    function getGifSizeValue(size) {
      switch (size) {
        case 'large': return '800';
        case 'medium': return '500';
        case 'small': return '300';
        case 'tiny': return '200';
        default: return '-1'; // original size
      }
    }

    function updateProgress(percent, message) {
      progressPercentage.textContent = `${percent}%`;
      progressFill.style.width = `${percent}%`;
      processingText.textContent = message;
    }

    // ---------- DOWNLOAD FUNCTIONS ----------
    function downloadGif() {
      if (!gifUrl) return;
      
      const link = document.createElement('a');
      link.href = gifUrl;
      link.download = 'animated.gif';
      document.body.appendChild(link);
      link.click();
      document.body.removeChild(link);
    }

    function resetGifMaker() {
      // Reset all sections
      videoInfoSection.classList.remove('active');
      timelineSection.classList.remove('active');
      gifSettingsSection.classList.remove('active');
      processingSection.classList.remove('active');
      resultSection.classList.remove('active');
      
      // Reset file input
      fileInput.value = '';
      uploadedFile = null;
      
      // Reset upload area text
      const uploadText = uploadArea.querySelector('.upload-text h3');
      uploadText.textContent = 'Upload Your Video';
      uploadArea.querySelector('.upload-text p').textContent = 'Drag & drop your video file here or click to browse';
      
      // Clear GIF URL
      if (gifUrl) {
        URL.revokeObjectURL(gifUrl);
        gifUrl = null;
      }
      
      // Reset video preview
      videoPreview.src = '';
      
      // Reset GIF preview
      gifPreview.innerHTML = '<p>Your GIF preview will appear here</p>';
      
      // Reset progress
      updateProgress(0, 'Initializing FFmpeg...');
    }

    // ---------- THEME TOGGLE ----------
    const themeToggle = document.getElementById("themeToggle");
    const prefersDarkScheme = window.matchMedia("(prefers-color-scheme: dark)");
    
    // Check for saved theme preference or use device preference
    const currentTheme = localStorage.getItem("theme") || 
                        (prefersDarkScheme.matches ? "dark" : "light");
    
    if (currentTheme === "light") {
      document.body.classList.add("light-mode");
    }
    
    themeToggle.addEventListener("click", () => {
      document.body.classList.toggle("light-mode");
      
      // Save theme preference
      const theme = document.body.classList.contains("light-mode") ? "light" : "dark";
      localStorage.setItem("theme", theme);
    });
    
    themeToggle.addEventListener("keypress", (e) => {
      if (e.key === "Enter" || e.key === " ") {
        document.body.classList.toggle("light-mode");
        
        // Save theme preference
        const theme = document.body.classList.contains("light-mode") ? "light" : "dark";
        localStorage.setItem("theme", theme);
      }
    });

    // ---------- INITIALIZATION ----------
    function initializeGifMaker() {
      initializeEventListeners();
    }

    // Initialize the GIF maker when the page loads
    document.addEventListener('DOMContentLoaded', initializeGifMaker);
  </script>
</body>
</html>